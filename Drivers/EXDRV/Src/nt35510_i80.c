
#include "main.h"
#include "lcd.h"

#if USE_LCD_NT35510

const reg_array_t nt35510_init[] = {
	fill_reg_array(0xF000, 0x55),
	fill_reg_array(0xF001, 0xAA),
	fill_reg_array(0xF002, 0x52),
	fill_reg_array(0xF003, 0x08),
	fill_reg_array(0xF004, 0x01),
	//# AVDD: manual, 
	fill_reg_array(0xB600, 0x34),
	fill_reg_array(0xB601, 0x34),
	fill_reg_array(0xB602, 0x34),

	fill_reg_array(0xB000, 0x0D),//09
	fill_reg_array(0xB001, 0x0D),
	fill_reg_array(0xB002, 0x0D),
	//# AVEE: manual,  -6V
	fill_reg_array(0xB700, 0x24),
	fill_reg_array(0xB701, 0x24),
	fill_reg_array(0xB702, 0x24),

	fill_reg_array(0xB100, 0x0D),
	fill_reg_array(0xB101, 0x0D),
	fill_reg_array(0xB102, 0x0D),
	//#Power Control for
	//VCL
	fill_reg_array(0xB800, 0x24),
	fill_reg_array(0xB801, 0x24),
	fill_reg_array(0xB802, 0x24),

	fill_reg_array(0xB200, 0x00),

	//# VGH: Clamp Enable, 
	fill_reg_array(0xB900, 0x24),
	fill_reg_array(0xB901, 0x24),
	fill_reg_array(0xB902, 0x24),

	fill_reg_array(0xB300, 0x05),
	fill_reg_array(0xB301, 0x05),
	fill_reg_array(0xB302, 0x05),

	///fill_reg_array(0xBF00, 0x01),

	//# VGL(LVGL):
	fill_reg_array(0xBA00, 0x34),
	fill_reg_array(0xBA01, 0x34),
	fill_reg_array(0xBA02, 0x34),
	//# VGL_REG(VGLO)
	fill_reg_array(0xB500, 0x0B),
	fill_reg_array(0xB501, 0x0B),
	fill_reg_array(0xB502, 0x0B),
	//# VGMP/VGSP:
	fill_reg_array(0xBC00, 0X00),
	fill_reg_array(0xBC01, 0xA3),
	fill_reg_array(0xBC02, 0X00),
	//# VGMN/VGSN
	fill_reg_array(0xBD00, 0x00),
	fill_reg_array(0xBD01, 0xA3),
	fill_reg_array(0xBD02, 0x00),
	//# VCOM=-0.1
	fill_reg_array(0xBE00, 0x00),
	fill_reg_array(0xBE01, 0x63),//4f
		//  VCOMH+0x01,
	//#R+
	fill_reg_array(0xD100, 0x00),
	fill_reg_array(0xD101, 0x37),
	fill_reg_array(0xD102, 0x00),
	fill_reg_array(0xD103, 0x52),
	fill_reg_array(0xD104, 0x00),
	fill_reg_array(0xD105, 0x7B),
	fill_reg_array(0xD106, 0x00),
	fill_reg_array(0xD107, 0x99),
	fill_reg_array(0xD108, 0x00),
	fill_reg_array(0xD109, 0xB1),
	fill_reg_array(0xD10A, 0x00),
	fill_reg_array(0xD10B, 0xD2),
	fill_reg_array(0xD10C, 0x00),
	fill_reg_array(0xD10D, 0xF6),
	fill_reg_array(0xD10E, 0x01),
	fill_reg_array(0xD10F, 0x27),
	fill_reg_array(0xD110, 0x01),
	fill_reg_array(0xD111, 0x4E),
	fill_reg_array(0xD112, 0x01),
	fill_reg_array(0xD113, 0x8C),
	fill_reg_array(0xD114, 0x01),
	fill_reg_array(0xD115, 0xBE),
	fill_reg_array(0xD116, 0x02),
	fill_reg_array(0xD117, 0x0B),
	fill_reg_array(0xD118, 0x02),
	fill_reg_array(0xD119, 0x48),
	fill_reg_array(0xD11A, 0x02),
	fill_reg_array(0xD11B, 0x4A),
	fill_reg_array(0xD11C, 0x02),
	fill_reg_array(0xD11D, 0x7E),
	fill_reg_array(0xD11E, 0x02),
	fill_reg_array(0xD11F, 0xBC),
	fill_reg_array(0xD120, 0x02),
	fill_reg_array(0xD121, 0xE1),
	fill_reg_array(0xD122, 0x03),
	fill_reg_array(0xD123, 0x10),
	fill_reg_array(0xD124, 0x03),
	fill_reg_array(0xD125, 0x31),
	fill_reg_array(0xD126, 0x03),
	fill_reg_array(0xD127, 0x5A),
	fill_reg_array(0xD128, 0x03),
	fill_reg_array(0xD129, 0x73),
	fill_reg_array(0xD12A, 0x03),
	fill_reg_array(0xD12B, 0x94),
	fill_reg_array(0xD12C, 0x03),
	fill_reg_array(0xD12D, 0x9F),
	fill_reg_array(0xD12E, 0x03),
	fill_reg_array(0xD12F, 0xB3),
	fill_reg_array(0xD130, 0x03),
	fill_reg_array(0xD131, 0xB9),
	fill_reg_array(0xD132, 0x03),
	fill_reg_array(0xD133, 0xC1),
	//#G+
	fill_reg_array(0xD200, 0x00),
	fill_reg_array(0xD201, 0x37),
	fill_reg_array(0xD202, 0x00),
	fill_reg_array(0xD203, 0x52),
	fill_reg_array(0xD204, 0x00),
	fill_reg_array(0xD205, 0x7B),
	fill_reg_array(0xD206, 0x00),
	fill_reg_array(0xD207, 0x99),
	fill_reg_array(0xD208, 0x00),
	fill_reg_array(0xD209, 0xB1),
	fill_reg_array(0xD20A, 0x00),
	fill_reg_array(0xD20B, 0xD2),
	fill_reg_array(0xD20C, 0x00),
	fill_reg_array(0xD20D, 0xF6),
	fill_reg_array(0xD20E, 0x01),
	fill_reg_array(0xD20F, 0x27),
	fill_reg_array(0xD210, 0x01),
	fill_reg_array(0xD211, 0x4E),
	fill_reg_array(0xD212, 0x01),
	fill_reg_array(0xD213, 0x8C),
	fill_reg_array(0xD214, 0x01),
	fill_reg_array(0xD215, 0xBE),
	fill_reg_array(0xD216, 0x02),
	fill_reg_array(0xD217, 0x0B),
	fill_reg_array(0xD218, 0x02),
	fill_reg_array(0xD219, 0x48),
	fill_reg_array(0xD21A, 0x02),
	fill_reg_array(0xD21B, 0x4A),
	fill_reg_array(0xD21C, 0x02),
	fill_reg_array(0xD21D, 0x7E),
	fill_reg_array(0xD21E, 0x02),
	fill_reg_array(0xD21F, 0xBC),
	fill_reg_array(0xD220, 0x02),
	fill_reg_array(0xD221, 0xE1),
	fill_reg_array(0xD222, 0x03),
	fill_reg_array(0xD223, 0x10),
	fill_reg_array(0xD224, 0x03),
	fill_reg_array(0xD225, 0x31),
	fill_reg_array(0xD226, 0x03),
	fill_reg_array(0xD227, 0x5A),
	fill_reg_array(0xD228, 0x03),
	fill_reg_array(0xD229, 0x73),
	fill_reg_array(0xD22A, 0x03),
	fill_reg_array(0xD22B, 0x94),
	fill_reg_array(0xD22C, 0x03),
	fill_reg_array(0xD22D, 0x9F),
	fill_reg_array(0xD22E, 0x03),
	fill_reg_array(0xD22F, 0xB3),
	fill_reg_array(0xD230, 0x03),
	fill_reg_array(0xD231, 0xB9),
	fill_reg_array(0xD232, 0x03),
	fill_reg_array(0xD233, 0xC1),
	//#B+
	fill_reg_array(0xD300, 0x00),
	fill_reg_array(0xD301, 0x37),
	fill_reg_array(0xD302, 0x00),
	fill_reg_array(0xD303, 0x52),
	fill_reg_array(0xD304, 0x00),
	fill_reg_array(0xD305, 0x7B),
	fill_reg_array(0xD306, 0x00),
	fill_reg_array(0xD307, 0x99),
	fill_reg_array(0xD308, 0x00),
	fill_reg_array(0xD309, 0xB1),
	fill_reg_array(0xD30A, 0x00),
	fill_reg_array(0xD30B, 0xD2),
	fill_reg_array(0xD30C, 0x00),
	fill_reg_array(0xD30D, 0xF6),
	fill_reg_array(0xD30E, 0x01),
	fill_reg_array(0xD30F, 0x27),
	fill_reg_array(0xD310, 0x01),
	fill_reg_array(0xD311, 0x4E),
	fill_reg_array(0xD312, 0x01),
	fill_reg_array(0xD313, 0x8C),
	fill_reg_array(0xD314, 0x01),
	fill_reg_array(0xD315, 0xBE),
	fill_reg_array(0xD316, 0x02),
	fill_reg_array(0xD317, 0x0B),
	fill_reg_array(0xD318, 0x02),
	fill_reg_array(0xD319, 0x48),
	fill_reg_array(0xD31A, 0x02),
	fill_reg_array(0xD31B, 0x4A),
	fill_reg_array(0xD31C, 0x02),
	fill_reg_array(0xD31D, 0x7E),
	fill_reg_array(0xD31E, 0x02),
	fill_reg_array(0xD31F, 0xBC),
	fill_reg_array(0xD320, 0x02),
	fill_reg_array(0xD321, 0xE1),
	fill_reg_array(0xD322, 0x03),
	fill_reg_array(0xD323, 0x10),
	fill_reg_array(0xD324, 0x03),
	fill_reg_array(0xD325, 0x31),
	fill_reg_array(0xD326, 0x03),
	fill_reg_array(0xD327, 0x5A),
	fill_reg_array(0xD328, 0x03),
	fill_reg_array(0xD329, 0x73),
	fill_reg_array(0xD32A, 0x03),
	fill_reg_array(0xD32B, 0x94),
	fill_reg_array(0xD32C, 0x03),
	fill_reg_array(0xD32D, 0x9F),
	fill_reg_array(0xD32E, 0x03),
	fill_reg_array(0xD32F, 0xB3),
	fill_reg_array(0xD330, 0x03),
	fill_reg_array(0xD331, 0xB9),
	fill_reg_array(0xD332, 0x03),
	fill_reg_array(0xD333, 0xC1),

	//#R-///////////////////////////////////////////
	fill_reg_array(0xD400, 0x00),
	fill_reg_array(0xD401, 0x37),
	fill_reg_array(0xD402, 0x00),
	fill_reg_array(0xD403, 0x52),
	fill_reg_array(0xD404, 0x00),
	fill_reg_array(0xD405, 0x7B),
	fill_reg_array(0xD406, 0x00),
	fill_reg_array(0xD407, 0x99),
	fill_reg_array(0xD408, 0x00),
	fill_reg_array(0xD409, 0xB1),
	fill_reg_array(0xD40A, 0x00),
	fill_reg_array(0xD40B, 0xD2),
	fill_reg_array(0xD40C, 0x00),
	fill_reg_array(0xD40D, 0xF6),
	fill_reg_array(0xD40E, 0x01),
	fill_reg_array(0xD40F, 0x27),
	fill_reg_array(0xD410, 0x01),
	fill_reg_array(0xD411, 0x4E),
	fill_reg_array(0xD412, 0x01),
	fill_reg_array(0xD413, 0x8C),
	fill_reg_array(0xD414, 0x01),
	fill_reg_array(0xD415, 0xBE),
	fill_reg_array(0xD416, 0x02),
	fill_reg_array(0xD417, 0x0B),
	fill_reg_array(0xD418, 0x02),
	fill_reg_array(0xD419, 0x48),
	fill_reg_array(0xD41A, 0x02),
	fill_reg_array(0xD41B, 0x4A),
	fill_reg_array(0xD41C, 0x02),
	fill_reg_array(0xD41D, 0x7E),
	fill_reg_array(0xD41E, 0x02),
	fill_reg_array(0xD41F, 0xBC),
	fill_reg_array(0xD420, 0x02),
	fill_reg_array(0xD421, 0xE1),
	fill_reg_array(0xD422, 0x03),
	fill_reg_array(0xD423, 0x10),
	fill_reg_array(0xD424, 0x03),
	fill_reg_array(0xD425, 0x31),
	fill_reg_array(0xD426, 0x03),
	fill_reg_array(0xD427, 0x5A),
	fill_reg_array(0xD428, 0x03),
	fill_reg_array(0xD429, 0x73),
	fill_reg_array(0xD42A, 0x03),
	fill_reg_array(0xD42B, 0x94),
	fill_reg_array(0xD42C, 0x03),
	fill_reg_array(0xD42D, 0x9F),
	fill_reg_array(0xD42E, 0x03),
	fill_reg_array(0xD42F, 0xB3),
	fill_reg_array(0xD430, 0x03),
	fill_reg_array(0xD431, 0xB9),
	fill_reg_array(0xD432, 0x03),
	fill_reg_array(0xD433, 0xC1),

	//#G-//////////////////////////////////////////////
	fill_reg_array(0xD500, 0x00),
	fill_reg_array(0xD501, 0x37),
	fill_reg_array(0xD502, 0x00),
	fill_reg_array(0xD503, 0x52),
	fill_reg_array(0xD504, 0x00),
	fill_reg_array(0xD505, 0x7B),
	fill_reg_array(0xD506, 0x00),
	fill_reg_array(0xD507, 0x99),
	fill_reg_array(0xD508, 0x00),
	fill_reg_array(0xD509, 0xB1),
	fill_reg_array(0xD50A, 0x00),
	fill_reg_array(0xD50B, 0xD2),
	fill_reg_array(0xD50C, 0x00),
	fill_reg_array(0xD50D, 0xF6),
	fill_reg_array(0xD50E, 0x01),
	fill_reg_array(0xD50F, 0x27),
	fill_reg_array(0xD510, 0x01),
	fill_reg_array(0xD511, 0x4E),
	fill_reg_array(0xD512, 0x01),
	fill_reg_array(0xD513, 0x8C),
	fill_reg_array(0xD514, 0x01),
	fill_reg_array(0xD515, 0xBE),
	fill_reg_array(0xD516, 0x02),
	fill_reg_array(0xD517, 0x0B),
	fill_reg_array(0xD518, 0x02),
	fill_reg_array(0xD519, 0x48),
	fill_reg_array(0xD51A, 0x02),
	fill_reg_array(0xD51B, 0x4A),
	fill_reg_array(0xD51C, 0x02),
	fill_reg_array(0xD51D, 0x7E),
	fill_reg_array(0xD51E, 0x02),
	fill_reg_array(0xD51F, 0xBC),
	fill_reg_array(0xD520, 0x02),
	fill_reg_array(0xD521, 0xE1),
	fill_reg_array(0xD522, 0x03),
	fill_reg_array(0xD523, 0x10),
	fill_reg_array(0xD524, 0x03),
	fill_reg_array(0xD525, 0x31),
	fill_reg_array(0xD526, 0x03),
	fill_reg_array(0xD527, 0x5A),
	fill_reg_array(0xD528, 0x03),
	fill_reg_array(0xD529, 0x73),
	fill_reg_array(0xD52A, 0x03),
	fill_reg_array(0xD52B, 0x94),
	fill_reg_array(0xD52C, 0x03),
	fill_reg_array(0xD52D, 0x9F),
	fill_reg_array(0xD52E, 0x03),
	fill_reg_array(0xD52F, 0xB3),
	fill_reg_array(0xD530, 0x03),
	fill_reg_array(0xD531, 0xB9),
	fill_reg_array(0xD532, 0x03),
	fill_reg_array(0xD533, 0xC1),
	//#B-///////////////////////////////
	fill_reg_array(0xD600, 0x00),
	fill_reg_array(0xD601, 0x37),
	fill_reg_array(0xD602, 0x00),
	fill_reg_array(0xD603, 0x52),
	fill_reg_array(0xD604, 0x00),
	fill_reg_array(0xD605, 0x7B),
	fill_reg_array(0xD606, 0x00),
	fill_reg_array(0xD607, 0x99),
	fill_reg_array(0xD608, 0x00),
	fill_reg_array(0xD609, 0xB1),
	fill_reg_array(0xD60A, 0x00),
	fill_reg_array(0xD60B, 0xD2),
	fill_reg_array(0xD60C, 0x00),
	fill_reg_array(0xD60D, 0xF6),
	fill_reg_array(0xD60E, 0x01),
	fill_reg_array(0xD60F, 0x27),
	fill_reg_array(0xD610, 0x01),
	fill_reg_array(0xD611, 0x4E),
	fill_reg_array(0xD612, 0x01),
	fill_reg_array(0xD613, 0x8C),
	fill_reg_array(0xD614, 0x01),
	fill_reg_array(0xD615, 0xBE),
	fill_reg_array(0xD616, 0x02),
	fill_reg_array(0xD617, 0x0B),
	fill_reg_array(0xD618, 0x02),
	fill_reg_array(0xD619, 0x48),
	fill_reg_array(0xD61A, 0x02),
	fill_reg_array(0xD61B, 0x4A),
	fill_reg_array(0xD61C, 0x02),
	fill_reg_array(0xD61D, 0x7E),
	fill_reg_array(0xD61E, 0x02),
	fill_reg_array(0xD61F, 0xBC),
	fill_reg_array(0xD620, 0x02),
	fill_reg_array(0xD621, 0xE1),
	fill_reg_array(0xD622, 0x03),
	fill_reg_array(0xD623, 0x10),
	fill_reg_array(0xD624, 0x03),
	fill_reg_array(0xD625, 0x31),
	fill_reg_array(0xD626, 0x03),
	fill_reg_array(0xD627, 0x5A),
	fill_reg_array(0xD628, 0x03),
	fill_reg_array(0xD629, 0x73),
	fill_reg_array(0xD62A, 0x03),
	fill_reg_array(0xD62B, 0x94),
	fill_reg_array(0xD62C, 0x03),
	fill_reg_array(0xD62D, 0x9F),
	fill_reg_array(0xD62E, 0x03),
	fill_reg_array(0xD62F, 0xB3),
	fill_reg_array(0xD630, 0x03),
	fill_reg_array(0xD631, 0xB9),
	fill_reg_array(0xD632, 0x03),
	fill_reg_array(0xD633, 0xC1),

	//#Enable Page0
	fill_reg_array(0xF000, 0x55),
	fill_reg_array(0xF001, 0xAA),
	fill_reg_array(0xF002, 0x52),
	fill_reg_array(0xF003, 0x08),
	fill_reg_array(0xF004, 0x00),
	//# RGB I/F Setting
	fill_reg_array(0xB000, 0x08),
	fill_reg_array(0xB001, 0x05),
	fill_reg_array(0xB002, 0x02),
	fill_reg_array(0xB003, 0x05),
	fill_reg_array(0xB004, 0x02),
	//## SDT:
	fill_reg_array(0xB600, 0x08),
	fill_reg_array(0xB500, 0x50),//0x6b 480x854       0x50 480x800

	//## Gate EQ:
	fill_reg_array(0xB700, 0x00),
	fill_reg_array(0xB701, 0x00),

	//## Source EQ:
	fill_reg_array(0xB800, 0x01),
	fill_reg_array(0xB801, 0x05),
	fill_reg_array(0xB802, 0x05),
	fill_reg_array(0xB803, 0x05),

	//# Inversion: Column inversion (NVT)
	fill_reg_array(0xBC00, 0x00),
	fill_reg_array(0xBC01, 0x00),
	fill_reg_array(0xBC02, 0x00),

	//# BOE's Setting(default)
	fill_reg_array(0xCC00, 0x03),
	fill_reg_array(0xCC01, 0x00),
	fill_reg_array(0xCC02, 0x00),

	//# Display Timing:
	fill_reg_array(0xBD00, 0x01),
	fill_reg_array(0xBD01, 0x84),
	fill_reg_array(0xBD02, 0x07),
	fill_reg_array(0xBD03, 0x31),
	fill_reg_array(0xBD04, 0x00),

	fill_reg_array(0xBA00, 0x01),

	fill_reg_array(0xFF00, 0xAA),
	fill_reg_array(0xFF01, 0x55),
	fill_reg_array(0xFF02, 0x25),
	fill_reg_array(0xFF03, 0x01),

	fill_reg_array(0x3500, 0x00),
	fill_reg_array(0x3600, 0x00),
	fill_reg_array(0x3a00, 0x55),  ////55=16bit/////66=18bit
	fill_reg_array(0x1100, 0xFFFF),
	fill_reg_array(DELAY_INSERT_FLAG,120),
	fill_reg_array(0x2900, 0xFFFF), 
	fill_reg_array(0x2c00, 0xFFFF),
};

const reg_map_t nt35510_reg_map[1] = {
	{
		.lcd_wramcmd = 0x2c00,
		.lcd_rramcmd = 0x2e00,
		.lcd_setxcmd = 0x2a00,
		.lcd_setycmd = 0x2b00,
		.lcd_xcursor = 0,
		.lcd_ycursor = 0,
	}
};

const lcd_info_t nt35510_disp_info[1] = {
	{
		.lcd_width = 480,
		.lcd_hight = 800,
		.lcd_id = 0x5510,
		.direction_reg = 0x3600,
		{
			.direction_up = 0x00,
			.direction_left = (1<<5) | (1<<6),
			.direction_down = (1<<7) | (1<<6),
			.direction_right = (1<<7) | (1<<5),
		},
	},
};

lcd_init_config(nt35510, nt35510_init, nt35510_reg_map, nt35510_disp_info)
{
	int ret = -1;
	
	uint16_t val;
	lcd_wr_reg(0xF000);
	lcd_wr_data(0x55);
	lcd_wr_reg(0xF001);
	lcd_wr_data(0xAA);
	lcd_wr_reg(0xF002);
	lcd_wr_data(0x52);
	lcd_wr_reg(0xF003);
	lcd_wr_data(0x08);
	lcd_wr_reg(0xF004);
	lcd_wr_data(0x01);

	lcd_wr_reg(0xC500);
	__delay_ms(1);
	val = lcd_read();
	lcd_wr_reg(0xC501);
	__delay_ms(1);
	val <<= 8;
	val |= lcd_read();
	printf("lcd id get = %x\n", val);
	ret = nt35510_disp_info->lcd_id == val ? 0:-1;
	
	return ret;
}

#endif